import{j as e}from"./mui-RVdzVS6v.js";import{r as v}from"./react-BeQ55maS.js";import{o as y}from"./main-zk8lyFQS.js";import{u as w}from"./i18n-QcaxvB6C.js";import"./stripe-D3dkS7W0.js";function R({stats:n,items:u,onClose:d,scanId:t}){const{t:s}=w(),[a,c]=v.useState(!1),x=new Date().toLocaleString(s("locale")||"en-US"),b=async()=>{var r,h;if(!(!t||a))try{c(!0);const o=await y(t),f=new Blob([o.data],{type:"application/pdf"}),m=window.URL.createObjectURL(f);let p=`scan-${t}-report.pdf`;const j=o.headers["content-disposition"]||((h=(r=o.headers).get)==null?void 0:h.call(r,"content-disposition"));if(j){const i=j.match(/filename="?([^";]+)"?/);i&&i[1]&&(p=i[1])}const l=document.createElement("a");l.href=m,l.download=p,document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(m)}catch(o){console.error("PDF download error:",o),alert(s("errors.pdfDownload"))}finally{c(!1)}};return e.jsx("div",{className:"wp-link-modal-backdrop",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{style:{margin:0},children:s("report.title")}),e.jsx("button",{className:"btn",onClick:d,"aria-label":s("common.close"),children:"âœ•"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[s("report.dateLabel"),": ",x]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[e.jsx("div",{className:"panel",children:e.jsxs("div",{className:"panel-body",children:[e.jsx("strong",{children:s("history.totalLinks")}),e.jsx("div",{style:{fontSize:24},children:n.total})]})}),e.jsx("div",{className:"panel",children:e.jsxs("div",{className:"panel-body",children:[e.jsx("strong",{children:s("results.status.ok")}),e.jsx("div",{style:{fontSize:24,color:"var(--color-success)"},children:n.ok})]})}),e.jsx("div",{className:"panel",children:e.jsxs("div",{className:"panel-body",children:[e.jsx("strong",{children:s("results.status.broken")}),e.jsx("div",{style:{fontSize:24,color:"var(--color-danger)"},children:n.broken})]})})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h4",{children:s("report.sampleTitle")}),e.jsx("div",{className:"table-wrap",children:e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:s("results.table.url")}),e.jsx("th",{children:s("results.table.type")}),e.jsx("th",{children:s("results.table.status")}),e.jsx("th",{children:s("results.table.foundOn")})]})}),e.jsx("tbody",{children:u.slice(0,10).map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.url}),e.jsx("td",{children:r.type}),e.jsx("td",{children:r.status}),e.jsx("td",{children:r.sources?s(r.sourceCount===1?"results.sources_one":"results.sources_other",{count:r.sourceCount}):r.source||"-"})]},r.id))})]})})]})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"btn",onClick:d,children:s("common.close")}),e.jsx("button",{className:"btn primary",onClick:b,disabled:!t||a,title:t?void 0:s("report.noScan"),children:s(a?"report.downloading":"report.downloadPdf")})]})]})})}export{R as default};
